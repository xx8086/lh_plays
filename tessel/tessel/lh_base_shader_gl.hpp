//
//  lh_base_shader_gl.hpp
//  tessel
//
//  Created by Liu,Han(ARL) on 2017/10/26.
//  Copyright © 2017年 Liu,Han(ARL). All rights reserved.
//

#ifndef lh_base_shader_gl_hpp
#define lh_base_shader_gl_hpp

#include "glbase.hpp"
#include "GLFW/glfw3.h"
#include "../poly2tri/poly2tri.h"
using namespace p2t;
using namespace std;
class CLhShaderGL:public CGL
{
public:
    CLhShaderGL();
    ~CLhShaderGL();
public:
    int run(int args, char *argv[]);
private:
    void insertpoint(float x, float y, float z);
    void processInput(GLFWwindow *window);
    bool loadshader();
    void loaddatas();
    bool Init();
    bool loopmain();
    void release();
    void setcamera();
    void draw();
    void create_vertex_buffer(float deep);
    void bind_vertex_buffer();
    void create_vertex_buffer_loacl();
    
    float str2f(const std::string& s);
    template <class C> void FreeClear( C & cntr ) {
        for ( typename C::iterator it = cntr.begin();
             it != cntr.end(); ++it ) {
            delete * it;
        }
        cntr.clear();
    }
private:
    typedef struct Vector3f{
        Vector3f(){};
        Vector3f(Point a, Point b, Point c, float deep)
        {
            x[0] = a.x/64.0;
            x[1] = a.y/64.0;
            x[2] = deep;
            y[0] = b.x/64.0;
            y[1] = b.y/64.0;
            y[2] = deep;
            z[0] = c.x/64.0;
            z[1] = c.y/64.0;
            z[2] = deep;
        };
        float x[3];
        float y[3];
        float z[3];
    } VECTOR_3F;
    vector<float>   triangle_points;
    vector< vector<Triangle*> > triangles;
    vector<CDT*> vec_cdt;
    vector< vector<Point*> > polylines;
    
    unsigned int SCR_WIDTH = 800;
    unsigned int SCR_HEIGHT = 600;
    
    
    unsigned int VBOs[2];
    unsigned int VAOs[2];
    GLFWwindow* window;
    
    unsigned int vertexShader;
    unsigned int fragmentShaderOrange;
    unsigned int shaderProgramOrange;
    
    float scalae = 1.0f;
    float twotriangle[18] = {
        -0.9f, -0.5f, 0.0f,  // left
        -0.0f, -0.5f, 0.0f,  // right
        -0.45f, 0.5f, 0.0f,  // top
        0.0f, -0.5f, 0.0f,  // left
        0.9f, -0.5f, 0.0f,  // right
        0.45f, 0.5f, 0.0f   // top
    };
    
    float arzi[1026] = {
        1348.80,18614.20,0.0, 3076.20,2361.80,0.0,6676.20,18614.20,0.0,
        1348.80,18614.20,0.0, 1348.80,536.80,0.0,3076.20,2361.80,0.0,
        1348.80,536.80,0.0, 3076.20,536.80,0.0,3076.20,2361.80,0.0,
        3076.20,2361.80,0.0, 4948.80,2361.80,0.0,6676.20,18614.20,0.0,
        4948.80,2361.80,0.0, 6676.20,936.80,0.0,6676.20,18614.20,0.0,
        4948.80,2361.80,0.0, 4948.80,936.80,0.0,6676.20,936.80,0.0,
        13976.20,19939.20,0.0, 7798.80,19939.20,0.0,12085.50,18161.80,0.0,
        12085.50,18161.80,0.0, 13976.20,18206.50,0.0,13976.20,19939.20,0.0,
        12085.50,18161.80,0.0, 13532.60,16479.20,0.0,13976.20,18206.50,0.0,
        12085.50,18161.80,0.0, 11717.20,16578.70,0.0,13532.60,16479.20,0.0,
        11717.20,16578.70,0.0, 13126.50,14916.00,0.0,13532.60,16479.20,0.0,
        11717.20,16578.70,0.0, 11348.20,15020.90,0.0,13126.50,14916.00,0.0,
        11348.20,15020.90,0.0, 12756.50,13510.90,0.0,13126.50,14916.00,0.0,
        11348.20,15020.90,0.0, 10993.30,13551.10,0.0,12756.50,13510.90,0.0,
        10993.30,13551.10,0.0, 12422.40,12263.60,0.0,12756.50,13510.90,0.0,
        10993.30,13551.10,0.0, 10652.30,12169.40,0.0,12422.40,12263.60,0.0,
        10652.30,12169.40,0.0, 12130.00,11194.90,0.0,12422.40,12263.60,0.0,
        10652.30,12169.40,0.0, 10320.10,10854.80,0.0,12130.00,11194.90,0.0,
        10320.10,10854.80,0.0, 10917.30,9867.00,0.0,12130.00,11194.90,0.0,
        12130.00,11194.90,0.0, 10917.30,9867.00,0.0,12689.50,10208.60,0.0,
        10917.30,9867.00,0.0, 11396.60,8937.34,0.0,12689.50,10208.60,0.0,
        12689.50,10208.60,0.0, 11396.60,8937.34,0.0,13158.20,9215.94,0.0,
        11396.60,8937.34,0.0, 11769.90,8046.40,0.0,13158.20,9215.94,0.0,
        13158.20,9215.94,0.0, 11769.90,8046.40,0.0,13524.80,8236.77,0.0,
        11769.90,8046.40,0.0, 12037.30,7194.30,0.0,13524.80,8236.77,0.0,
        13524.80,8236.77,0.0, 12037.30,7194.30,0.0,13789.10,7271.08,0.0,
        12037.30,7194.30,0.0, 12199.30,6380.55,0.0,13789.10,7271.08,0.0,
        13789.10,7271.08,0.0, 12199.30,6380.55,0.0,13950.90,6319.13,0.0,
        12199.30,6380.55,0.0, 12313.70,5180.50,0.0,13950.90,6319.13,0.0,
        13950.90,6319.13,0.0, 12313.70,5180.50,0.0,14073.40,4601.33,0.0,
        12313.70,5180.50,0.0, 12279.00,4231.48,0.0,14073.40,4601.33,0.0,
        12279.00,4231.48,0.0, 13938.30,3217.29,0.0,14073.40,4601.33,0.0,
        12279.00,4231.48,0.0, 12097.90,3536.25,0.0,13938.30,3217.29,0.0,
        13938.30,3217.29,0.0, 12097.90,3536.25,0.0,13542.40,2166.56,0.0,
        12097.90,3536.25,0.0, 11776.70,3093.26,0.0,13542.40,2166.56,0.0,
        11776.70,3093.26,0.0, 12881.70,1453.71,0.0,13542.40,2166.56,0.0,
        12881.70,1453.71,0.0, 11776.70,3093.26,0.0,11963.60,1088.31,0.0,
        11776.70,3093.26,0.0, 11311.30,2887.90,0.0,11963.60,1088.31,0.0,
        11311.30,2887.90,0.0, 11644.90,1038.11,0.0,11963.60,1088.31,0.0,
        11311.30,2887.90,0.0, 11288.30,1010.82,0.0,11644.90,1038.11,0.0,
        10985.70,2848.17,0.0, 11288.30,1010.82,0.0,11311.30,2887.90,0.0,
        10985.70,2848.17,0.0, 10890.30,1005.79,0.0,11288.30,1010.82,0.0,
        10643.30,2845.22,0.0, 10890.30,1005.79,0.0,10985.70,2848.17,0.0,
        10890.30,1005.79,0.0, 10643.30,2845.22,0.0,9781.01,1849.90,0.0,
        10890.30,1005.79,0.0, 9781.01,1849.90,0.0,10450.90,1022.88,0.0,
        10450.90,1022.88,0.0, 9781.01,1849.90,0.0,9858.72,1475.33,0.0,
        9858.72,1475.33,0.0, 9931.49,1065.17,0.0,10450.90,1022.88,0.0,
        9781.01,1849.90,0.0, 10643.30,2845.22,0.0,10288.40,2879.72,0.0,
        10288.40,2879.72,0.0, 9691.34,2228.53,0.0,9781.01,1849.90,0.0,
        10288.40,2879.72,0.0, 9921.06,2951.81,0.0,9691.34,2228.53,0.0,
        9691.34,2228.53,0.0, 9921.06,2951.81,0.0,9589.69,2611.21,0.0,
        9921.06,2951.81,0.0, 10320.10,10854.80,0.0,9589.69,2611.21,0.0,
        10917.30,9867.00,0.0, 10320.10,10854.80,0.0,9921.06,2951.81,0.0,
        11396.60,8937.34,0.0, 10917.30,9867.00,0.0,9921.06,2951.81,0.0,
        11396.60,8937.34,0.0, 9921.06,2951.81,0.0,10288.40,2879.72,0.0,
        10288.40,2879.72,0.0, 10643.30,2845.22,0.0,11396.60,8937.34,0.0,
        11769.90,8046.40,0.0, 11396.60,8937.34,0.0,10643.30,2845.22,0.0,
        10985.70,2848.17,0.0, 11769.90,8046.40,0.0,10643.30,2845.22,0.0,
        10985.70,2848.17,0.0, 12037.30,7194.30,0.0,11769.90,8046.40,0.0,
        11311.30,2887.90,0.0, 12037.30,7194.30,0.0,10985.70,2848.17,0.0,
        12199.30,6380.55,0.0, 12037.30,7194.30,0.0,11311.30,2887.90,0.0,
        11776.70,3093.26,0.0, 12199.30,6380.55,0.0,11311.30,2887.90,0.0,
        12313.70,5180.50,0.0, 12199.30,6380.55,0.0,11776.70,3093.26,0.0,
        11776.70,3093.26,0.0, 12279.00,4231.48,0.0,12313.70,5180.50,0.0,
        12279.00,4231.48,0.0, 11776.70,3093.26,0.0,12097.90,3536.25,0.0,
        9589.69,2611.21,0.0, 10320.10,10854.80,0.0,9526.20,18161.80,0.0,
        9526.20,18161.80,0.0, 10320.10,10854.80,0.0,10652.30,12169.40,0.0,
        9526.20,18161.80,0.0, 10652.30,12169.40,0.0,10993.30,13551.10,0.0,
        9526.20,18161.80,0.0, 10993.30,13551.10,0.0,11348.20,15020.90,0.0,
        9526.20,18161.80,0.0, 11348.20,15020.90,0.0,11717.20,16578.70,0.0,
        9526.20,18161.80,0.0, 11717.20,16578.70,0.0,12085.50,18161.80,0.0,
        7798.80,19939.20,0.0, 9526.20,18161.80,0.0,12085.50,18161.80,0.0,
        7798.80,19939.20,0.0, 9449.57,3088.10,0.0,9526.20,18161.80,0.0,
        7798.80,19939.20,0.0, 7798.80,-3589.20,0.0,9449.57,3088.10,0.0,
        7798.80,-3589.20,0.0, 9526.20,-3589.20,0.0,9449.57,3088.10,0.0,
        9449.57,3088.10,0.0, 9526.20,-3589.20,0.0,9526.20,18161.80,0.0,
        14973.80,14389.20,0.0, 16651.20,3861.80,0.0,20251.20,14389.20,0.0,
        14973.80,14389.20,0.0, 14973.80,1886.80,0.0,16651.20,3861.80,0.0,
        14973.80,1886.80,0.0, 16651.20,1886.80,0.0,16651.20,3861.80,0.0,
        16651.20,3861.80,0.0, 20251.20,3861.80,0.0,20251.20,14389.20,0.0,
        14723.80,19664.20,0.0, 21573.80,17886.80,0.0,25251.20,19664.20,0.0,
        14723.80,19664.20,0.0, 14723.80,17886.80,0.0,21573.80,17886.80,0.0,
        21573.80,17886.80,0.0, 23351.20,17886.80,0.0,25251.20,19664.20,0.0,
        23351.20,17886.80,0.0, 21573.80,17886.80,0.0,21573.80,265.42,0.0,
        23351.20,17886.80,0.0, 21573.80,265.42,0.0,23351.20,-115.49,0.0,
        21573.80,265.42,0.0, 21522.60,-274.98,0.0,23351.20,-115.49,0.0,
        21522.60,-274.98,0.0, 23249.30,-1160.67,0.0,23351.20,-115.49,0.0,
        21522.60,-274.98,0.0, 21372.10,-687.44,0.0,23249.30,-1160.67,0.0,
        23249.30,-1160.67,0.0, 21372.10,-687.44,0.0,22940.70,-1983.64,0.0,
        22940.70,-1983.64,0.0, 21372.10,-687.44,0.0,21124.70,-977.75,0.0,
        22940.70,-1983.64,0.0, 21124.70,-977.75,0.0,22422.90,-2578.30,0.0,
        22422.90,-2578.30,0.0, 21124.70,-977.75,0.0,21699.30,-2938.59,0.0,
        21124.70,-977.75,0.0, 20777.80,-1152.31,0.0,21699.30,-2938.59,0.0,
        21699.30,-2938.59,0.0, 20777.80,-1152.31,0.0,20778.80,-3064.16,0.0,
        20777.80,-1152.31,0.0, 20322.00,-1211.75,0.0,20778.80,-3064.16,0.0,
        20322.00,-1211.75,0.0, 20231.40,-3071.20,0.0,20778.80,-3064.16,0.0,
        19739.40,-1203.81,0.0, 20231.40,-3071.20,0.0,20322.00,-1211.75,0.0,
        19739.40,-1203.81,0.0, 19658.80,-3072.20,0.0,20231.40,-3071.20,0.0,
        19159.80,-1179.87,0.0, 19658.80,-3072.20,0.0,19739.40,-1203.81,0.0,
        19159.80,-1179.87,0.0, 19058.30,-3067.20,0.0,19658.80,-3072.20,0.0,
        18586.30,-1139.97,0.0, 19058.30,-3067.20,0.0,19159.80,-1179.87,0.0,
        18586.30,-1139.97,0.0, 18429.90,-3056.19,0.0,19058.30,-3067.20,0.0,
        18586.30,-1139.97,0.0, 17624.40,-2231.90,0.0,18429.90,-3056.19,0.0,
        17559.60,-1848.13,0.0, 17624.40,-2231.90,0.0,18586.30,-1139.97,0.0,
        18586.30,-1139.97,0.0, 18018.80,-1084.12,0.0,17559.60,-1848.13,0.0,
        18018.80,-1084.12,0.0, 17484.90,-1462.34,0.0,17559.60,-1848.13,0.0,
        17384.50,-1003.00,0.0, 17484.90,-1462.34,0.0,18018.80,-1084.12,0.0,
        18429.90,-3056.19,0.0, 17624.40,-2231.90,0.0,17679.20,-2613.64,0.0,
        17679.20,-2613.64,0.0, 17729.40,-3038.03,0.0,18429.90,-3056.19,0.0,
        23351.20,17886.80,0.0, 25251.20,17886.80,0.0,25251.20,19664.20,0.0,
        3076.20,16836.80,0.0, 4948.80,4139.20,0.0,4948.80,16836.80,0.0,
        3076.20,16836.80,0.0, 3076.20,4139.20,0.0,4948.80,4139.20,0.0,
        18573.80,12661.80,0.0, 16651.20,12661.80,0.0,16651.20,5589.20,0.0,
        18573.80,12661.80,0.0, 16651.20,5589.20,0.0,18573.80,5589.20,0.0
    };
};


#endif /* lh_base_shader_gl_hpp */
